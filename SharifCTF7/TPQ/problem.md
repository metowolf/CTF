# TPQ

`nc ctf.sharif.edu 4000`

log
```bash
meto@Yoga-3:~$ nc ctf.sharif.edu 4000
Our ultra-secure system is generating 10 primes... Done!
Please choose options quickly and carefully.
Options:
	[C]hoose two distinct indices to encrypt the flag
	[R]eveal the encryption function
	[Q]uit.
C
Send two distinct indices smaller than 10, separated by space.
1 2
The encrypted flag is: 35248451088102897325201747384988307868596152046070318935600556864264176428178168631832281387807355624413475934734580436930831759500033953322682159189676941852280625625827746451617562539452110694138787962204193133260350716007734111234666067177855723946811288168117309355943840265361766527788918006357612828886
Options:
	[C]hoose two distinct indices to encrypt the flag
	[R]eveal the encryption function
	[Q]uit.
C
Send two distinct indices smaller than 10, separated by space.
1 3
The encrypted flag is: 74666223109572371352434467002765203619010589200964486979676278903918879791223754359150379270085903166400176382232795290048114803965004235229653615769630430588603835086436206290960521487896805969183313981542885895300566025301710156912327324998316190165604044640066015941998646371688325975728120262647653359127
Options:
	[C]hoose two distinct indices to encrypt the flag
	[R]eveal the encryption function
	[Q]uit.
C
Send two distinct indices smaller than 10, separated by space.
1 4
The encrypted flag is: 64962548385502358696600302124626625458345511671373359118520449581874624295778610579824409586416665109006952165116799035383790356817232996957580216280184577990096372516817672114523298215471562201651807414742586166026366364315463695761885604544297102738254691727914659760906597964009338400493768070371865228931
Options:
	[C]hoose two distinct indices to encrypt the flag
	[R]eveal the encryption function
	[Q]uit.
C
Send two distinct indices smaller than 10, separated by space.
2 3
The encrypted flag is: 53832216541355992864194959985946899323411416776290319183266666705247067391189606674477325311863426262411813313789919861853845881795187966365151352299190114498468044494825562509417667676448924235175917953159431553958173543242087154583210776169482708419505299938155406988727336436194732724690859927439142763813
Options:
	[C]hoose two distinct indices to encrypt the flag
	[R]eveal the encryption function
	[Q]uit.
C
Send two distinct indices smaller than 10, separated by space.
2 4
The encrypted flag is: 42233765892697487791812713693511855174456383097671681241134786006063315923651547568203454919141180730800155794188625722366573833689249997489782271131342454196575459790177330694767537215542477726705684305554066306826082983941726328524919510797157408058428450270636002589613985439717977993611215999234356560036
Options:
	[C]hoose two distinct indices to encrypt the flag
	[R]eveal the encryption function
	[Q]uit.
R
def encrypt(m, p, q):
	e = 65537
	return gmpy2.powmod(bytes_to_long(m), e, p*q)
Options:
	[C]hoose two distinct indices to encrypt the flag
	[R]eveal the encryption function
	[Q]uit.
Q
Quiting ...
meto@Yoga-3:~$
```
